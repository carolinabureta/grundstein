<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=My><meta name=author content=Lyz><link href=https://www.labastelaria.com/vdirsyncer/ rel=canonical><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.11"><title>vdirsyncer - The Red Lobster Book</title><link rel=stylesheet href=../assets/stylesheets/main.7e359304.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../stylesheets/extra.css><link rel=stylesheet href=../stylesheets/links.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#installation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> </div> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="The Red Lobster Book" class="md-header__button md-logo" aria-label="The Red Lobster Book" data-md-component=logo> <img src=../img/logo.bmp alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> The Red Lobster Book </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> vdirsyncer </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/realcaptainsolaris/redbook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> realcaptainsolaris/redbook </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="The Red Lobster Book" class="md-nav__button md-logo" aria-label="The Red Lobster Book" data-md-component=logo> <img src=../img/logo.bmp alt=logo> </a> The Red Lobster Book </label> <div class=md-nav__source> <a href=https://github.com/realcaptainsolaris/redbook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> realcaptainsolaris/redbook </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../contact/ class=md-nav__link> <span class=md-ellipsis> Contact </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Uebungen </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Uebungen </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../uebungen/beispiel/ class=md-nav__link> <span class=md-ellipsis> Test1 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> DesignLab </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> DesignLab </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../designlab/slime.md class=md-nav__link> <span class=md-ellipsis> Slime </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> DesignClub </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> DesignClub </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../designclub/concept.md class=md-nav__link> <span class=md-ellipsis> Concept </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#installation class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> <nav class=md-nav aria-label=Installation> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> <nav class=md-nav aria-label=Configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#syncing-a-calendar class=md-nav__link> <span class=md-ellipsis> Syncing a calendar </span> </a> </li> <li class=md-nav__item> <a href=#syncing-an-address-book class=md-nav__link> <span class=md-ellipsis> Syncing an address book </span> </a> </li> <li class=md-nav__item> <a href=#conflict-resolution class=md-nav__link> <span class=md-ellipsis> Conflict resolution </span> </a> </li> <li class=md-nav__item> <a href=#ssl-and-certificate-validation class=md-nav__link> <span class=md-ellipsis> SSL and certificate validation </span> </a> </li> <li class=md-nav__item> <a href=#storing-passwords class=md-nav__link> <span class=md-ellipsis> Storing passwords </span> </a> </li> <li class=md-nav__item> <a href=#google class=md-nav__link> <span class=md-ellipsis> Google </span> </a> <nav class=md-nav aria-label=Google> <ul class=md-nav__list> <li class=md-nav__item> <a href=#official-steps class=md-nav__link> <span class=md-ellipsis> Official steps </span> </a> </li> <li class=md-nav__item> <a href=#use-nekr0z-patch-solution class=md-nav__link> <span class=md-ellipsis> Use Nekr0z patch solution </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#see-differences-between-syncs class=md-nav__link> <span class=md-ellipsis> See differences between syncs </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>vdirsyncer</h1> <p><a href=https://vdirsyncer.pimutils.org/en/stable/ >vdirsyncer</a> is a Python command-line tool for synchronizing calendars and addressbooks between a variety of servers and the local filesystem. The most popular usecase is to synchronize a server with a local folder and use a set of other programs such as <a href=../khal/ ><code>khal</code></a> to change the local events and contacts. Vdirsyncer can then synchronize those changes back to the server.</p> <p>However, <code>vdirsyncer</code> is not limited to synchronizing between clients and servers. It can also be used to synchronize calendars and/or addressbooks between two servers directly.</p> <p>It aims to be for calendars and contacts what OfflineIMAP is for emails.</p> <h2 id=installation><a href=https://vdirsyncer.pimutils.org/en/stable/installation.html>Installation</a><a class=headerlink href=#installation title="Permanent link">⚑</a></h2> <p>Although it's available in the major package managers, you can get a more bleeding edge version with <code>pip</code>.</p> <div class=highlight><pre><span></span><code>pipx<span class=w> </span>install<span class=w> </span>vdirsyncer
</code></pre></div> <p>If you don't have <a href=../pipx/ ><code>pipx</code></a> you can use <code>pip</code>.</p> <p>You also need to install some dependencies for it to work:</p> <div class=highlight><pre><span></span><code>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>libxml2<span class=w> </span>libxslt1.1<span class=w> </span>zlib1g
</code></pre></div> <h3 id=configuration><a href=https://vdirsyncer.pimutils.org/en/stable/tutorial.html>Configuration</a><a class=headerlink href=#configuration title="Permanent link">⚑</a></h3> <p>In this example we set up contacts synchronization, but calendar sync works almost the same. Just swap <code>type = "carddav"</code> for <code>type = "caldav"</code> and <code>fileext = ".vcf"</code> for <code>fileext = ".ics"</code>.</p> <p>By default, <code>vdirsyncer</code> looks for its configuration file in the following locations:</p> <ul> <li>The file pointed to by the <code>VDIRSYNCER_CONFIG</code> environment variable.</li> <li><code>~/.vdirsyncer/config</code>.</li> <li><code>$XDG_CONFIG_HOME/vdirsyncer/config</code>, which is normally <code>~/.config/vdirsyncer/config</code>.</li> </ul> <p>You need to create the directory as it's not created by default and the <a href=https://github.com/pimutils/vdirsyncer/blob/main/config.example>base config file</a>.</p> <p>The config file should start with a general section, where the only required parameter is status_path. The following is a minimal example:</p> <div class=highlight><pre><span></span><code><span class=k>[general]</span>
<span class=na>status_path</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;~/.vdirsyncer/status/&quot;</span>
</code></pre></div> <p>After the <code>general</code> section, an arbitrary amount of pair and storage sections might come.</p> <p>In vdirsyncer, synchronization is always done between two storages. Such storages are defined in storage sections, and which pairs of storages should actually be synchronized is defined in pair section. This format is copied from OfflineIMAP, where storages are called repositories and pairs are called accounts.</p> <h4 id=syncing-a-calendar>Syncing a calendar<a class=headerlink href=#syncing-a-calendar title="Permanent link">⚑</a></h4> <p>To sync to a nextcloud calendar:</p> <div class=highlight><pre><span></span><code><span class=k>[pair my_calendars]</span>
<span class=na>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;my_calendars_local&quot;</span>
<span class=na>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;my_calendars_remote&quot;</span>
<span class=na>collections</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;from a&quot;, &quot;from b&quot;]</span>
<span class=na>metadata</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;color&quot;]</span>

<span class=k>[storage my_calendars_local]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;filesystem&quot;</span>
<span class=na>path</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;~/.calendars/&quot;</span>
<span class=na>fileext</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;.ics&quot;</span>

<span class=k>[storage my_calendars_remote]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;caldav&quot;</span>
<span class=c1>#Can be obtained from nextcloud</span>
<span class=na>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;https://yournextcloud.example.lcl/remote.php/dav/calendars/USERNAME/personal/&quot;</span>
<span class=na>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;&lt;USERNAME&gt;&quot;</span>
<span class=c1>#Instead of inserting my plaintext password I fetch it using pass</span>
<span class=na>password.fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;command&quot;, &quot;pass&quot;, &quot;nextcloud&quot;]</span>
<span class=c1>#SSL certificate fingerprint</span>
<span class=na>verify_fingerprint</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;FINGERPRINT&quot;</span>
<span class=c1>#Verify ssl certificate. Set to false if it is self signed and not installed on local machine</span>
<span class=na>verify</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>true</span>
</code></pre></div> <p>Read the <a href=#ssl-and-certificate-validation>SSl and certificate validation</a> section to see how to create the <code>verify_fingerprint</code>.</p> <h4 id=syncing-an-address-book>Syncing an address book<a class=headerlink href=#syncing-an-address-book title="Permanent link">⚑</a></h4> <p>The following example synchronizes ownCloud’s addressbooks to <code>~/.contacts/</code>:</p> <div class=highlight><pre><span></span><code><span class=k>[pair my_contacts]</span>
<span class=na>a</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;my_contacts_local&quot;</span>
<span class=na>b</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;my_contacts_remote&quot;</span>
<span class=na>collections</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;from a&quot;, &quot;from b&quot;]</span>

<span class=k>[storage my_contacts_local]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;filesystem&quot;</span>
<span class=na>path</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;~/.contacts/&quot;</span>
<span class=na>fileext</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;.vcf&quot;</span>

<span class=k>[storage my_contacts_remote]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;carddav&quot;</span>

<span class=c1># We can simplify this URL here as well. In theory it shouldn&#39;t matter.</span>
<span class=na>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;https://owncloud.example.com/remote.php/carddav/&quot;</span>
<span class=na>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;bob&quot;</span>
<span class=na>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;asdf&quot;</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <pre><code>Configuration for other servers can be found at
[Servers](https://vdirsyncer.pimutils.org/en/stable/tutorials/index.html#supported-servers).
</code></pre> </div> <p>After running <code>vdirsyncer discover</code> and <code>vdirsyncer sync</code>, <code>~/.contacts/</code> will contain subdirectories for each addressbook, which in turn will contain a bunch of <code>.vcf</code> files which all contain a contact in VCARD format each. You can modify their contents, add new ones and delete some, and your changes will be synchronized to the CalDAV server after you run <code>vdirsyncer sync</code> again.</p> <h4 id=conflict-resolution><a href=https://vdirsyncer.pimutils.org/en/stable/tutorial.html#conflict-resolution>Conflict resolution</a><a class=headerlink href=#conflict-resolution title="Permanent link">⚑</a></h4> <p>If the same item is changed on both sides <code>vdirsyncer</code> can manage the conflict in three ways:</p> <ul> <li>Displaying an error message (the default).</li> <li>Choosing one alternative version over the other.</li> <li>Starts a command of your choice that is supposed to merge the two alternative versions.</li> </ul> <p>Options 2 and 3 require adding a <code>conflict_resolution</code> parameter to the pair section. Option 2 requires giving either <code>a wins</code> or <code>b wins</code> as value to the parameter:</p> <div class=highlight><pre><span></span><code><span class=k>[pair my_contacts]</span>
<span class=na>...</span>
<span class=na>conflict_resolution</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;b wins&quot;</span>
</code></pre></div> <p>Earlier we wrote that <code>b = "my_contacts_remote"</code>, so when <code>vdirsyncer</code> encounters the situation where an item changed on both sides, it will simply overwrite the local item with the one from the server.</p> <p>Option 3 requires specifying as value of <code>conflict_resolution</code> an array starting with <code>command</code> and containing paths and arguments to a command. For example:</p> <div class=highlight><pre><span></span><code><span class=k>[pair my_contacts]</span>
<span class=na>...</span>
<span class=na>conflict_resolution</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;command&quot;, &quot;vimdiff&quot;]</span>
</code></pre></div> <p>In this example, <code>vimdiff &lt;a&gt; &lt;b&gt;</code> will be called with <code>&lt;a&gt;</code> and <code>&lt;b&gt;</code> being two temporary files containing the conflicting files. The files need to be exactly the same when the command returns. More arguments can be passed to the command by adding more elements to the array.</p> <h4 id=ssl-and-certificate-validation><a href=https://vdirsyncer.pimutils.org/en/stable/ssl-tutorial.html>SSL and certificate validation</a><a class=headerlink href=#ssl-and-certificate-validation title="Permanent link">⚑</a></h4> <p>To pin the certificate by fingerprint:</p> <div class=highlight><pre><span></span><code><span class=k>[storage foo]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;caldav&quot;</span>
<span class=na>...</span>
<span class=na>verify_fingerprint</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;94:FD:7A:CB:50:75:A4:69:82:0A:F8:23:DF:07:FC:69:3E:CD:90:CA&quot;</span>
<span class=c1>#verify = false  # Optional: Disable CA validation, useful for self-signed certs</span>
</code></pre></div> <p>SHA1-, SHA256- or MD5-Fingerprints can be used.</p> <p>You can use the following command for obtaining a SHA-1 fingerprint:</p> <div class=highlight><pre><span></span><code><span class=nb>echo</span><span class=w> </span>-n<span class=w> </span><span class=p>|</span><span class=w> </span>openssl<span class=w> </span>s_client<span class=w> </span>-connect<span class=w> </span>unterwaditzer.net:443<span class=w> </span><span class=p>|</span><span class=w> </span>openssl<span class=w> </span>x509<span class=w> </span>-noout<span class=w> </span>-fingerprint
</code></pre></div> <p>Note that <code>verify_fingerprint</code> doesn't suffice for <code>vdirsyncer</code> to work with self-signed certificates (or certificates that are not in your trust store). You most likely need to set <code>verify = false</code> as well. This disables verification of the SSL certificate’s expiration time and the existence of it in your trust store, all that’s verified now is the fingerprint.</p> <p>However, please consider using Let’s Encrypt such that you can forget about all of that. It is easier to deploy a free certificate from them than configuring all of your clients to accept the self-signed certificate.</p> <h4 id=storing-passwords><a href=https://vdirsyncer.pimutils.org/en/stable/keyring.html>Storing passwords</a><a class=headerlink href=#storing-passwords title="Permanent link">⚑</a></h4> <p><code>vdirsyncer</code> can fetch passwords from several sources other than the config file.</p> <p>Say you have the following configuration:</p> <div class=highlight><pre><span></span><code><span class=k>[storage foo]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;caldav&quot;</span>
<span class=na>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>...</span>
<span class=na>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;foo&quot;</span>
<span class=na>password</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;bar&quot;</span>
</code></pre></div> <p>But it bugs you that the password is stored in cleartext in the config file. You can do this:</p> <div class=highlight><pre><span></span><code><span class=k>[storage foo]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;caldav&quot;</span>
<span class=na>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>...</span>
<span class=na>username</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;foo&quot;</span>
<span class=na>password.fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;command&quot;, &quot;~/get-password.sh&quot;, &quot;more&quot;, &quot;args&quot;]</span>
</code></pre></div> <p>You can fetch the username as well:</p> <div class=highlight><pre><span></span><code><span class=k>[storage foo]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;caldav&quot;</span>
<span class=na>url</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>...</span>
<span class=na>username.fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;command&quot;, &quot;~/get-username.sh&quot;]</span>
<span class=na>password.fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;command&quot;, &quot;~/get-password.sh&quot;]</span>
</code></pre></div> <p>Or really any kind of parameter in a storage section.</p> <p>With <code>pass</code> for example, you might find yourself writing something like this in your configuration file:</p> <div class=highlight><pre><span></span><code><span class=na>password.fetch</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>[&quot;command&quot;, &quot;pass&quot;, &quot;caldav&quot;]</span>
</code></pre></div> <h4 id=google><a href=https://vdirsyncer.pimutils.org/en/stable/config.html#google>Google</a><a class=headerlink href=#google title="Permanent link">⚑</a></h4> <p><code>vdirsyncer</code> supports synchronization with Google calendars with the restriction that VTODO files are rejected by the server.</p> <p>Synchronization with Google contacts is less reliable due to negligence of Google’s CardDAV API. Google’s CardDAV implementation is allegedly a disaster in terms of data safety. Always back up your data.</p> <p>At first run you will be asked to authorize application for Google account access.</p> <p>To use this storage type, you need to install some additional dependencies:</p> <div class=highlight><pre><span></span><code>pip<span class=w> </span>install<span class=w> </span>vdirsyncer<span class=o>[</span>google<span class=o>]</span>
</code></pre></div> <h5 id=official-steps>Official steps<a class=headerlink href=#official-steps title="Permanent link">⚑</a></h5> <div class="admonition warning"> <p class=admonition-title>As of 2022-10-13 these didn't work for me, see the next section</p> </div> <p>Furthermore you need to register <code>vdirsyncer</code> as an application yourself to obtain <code>client_id</code> and <code>client_secret</code>, as it is against Google’s Terms of Service to hardcode those into open source software:</p> <ul> <li>Go to the <a href=https://console.developers.google.com/ >Google API Manager</a> and create a new project under any name.</li> <li>Within that project, enable the <code>CalDAV</code> and <code>CardDAV</code> APIs (not the Calendar and Contacts APIs, those are different and won’t work). There should be a searchbox where you can just enter those terms.</li> <li>In the sidebar, select <code>Credentials</code> and create a new <code>OAuth Client ID</code>. The application type is <code>Other</code>.</li> <li>You’ll be prompted to create a OAuth consent screen first. Fill out that form however you like.</li> <li>Finally you should have a Client ID and a Client secret. Provide these in your storage config.</li> </ul> <p>The <code>token_file</code> parameter should be a <code>filepath</code> where vdirsyncer can later store authentication-related data. You do not need to create the file itself or write anything to it.</p> <div class=highlight><pre><span></span><code><span class=k>[storage example_for_google_calendar]</span>
<span class=na>type</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;google_calendar&quot;</span>
<span class=na>token_file</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;...&quot;</span>
<span class=na>client_id</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;...&quot;</span>
<span class=na>client_secret</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;...&quot;</span>
<span class=c1>#start_date = null</span>
<span class=c1>#end_date = null</span>
<span class=c1>#item_types = []</span>
</code></pre></div> <h5 id=use-nekr0z-patch-solution><a href=https://github.com/pimutils/vdirsyncer/issues/975>Use Nekr0z patch solution</a><a class=headerlink href=#use-nekr0z-patch-solution title="Permanent link">⚑</a></h5> <div class="admonition note"> <p class=admonition-title>look the previous section if you have doubts on any of the steps</p> </div> <p>If the official steps failed for you, try these ones:</p> <ul> <li>Go to the <a href=https://console.developers.google.com/ >Google API Manager</a> and create a new project under any name.</li> <li>Selected the vdirsyncer project</li> <li>Went to Credentials -&gt; Create Credentials -&gt; OAuth Client ID</li> <li>Select "Web Application"</li> <li>Under "Authorised redirect URIs" added <code>http://127.0.0.1:8088</code> pressed "Create".</li> <li>Edit your <code>vdirsyncer</code> <code>config</code> [storage google] section to have the new client_id and client_secret ().</li> <li> <p>Find the location of the <code>vdirsyncer/storage/google.py</code> in your environment (mine was in <code>~/.local/pipx/venvs/vdirsyncer/lib/python3.10/site-packages/vdirsyncer/storage</code>) and changed line 65 from</p> <div class=highlight><pre><span></span><code><span class=n>redirect_uri</span><span class=o>=</span><span class=s2>&quot;urn:ietf:wg:oauth:2.0:oob&quot;</span><span class=p>,</span>
</code></pre></div> <p>to</p> <div class=highlight><pre><span></span><code><span class=n>redirect_uri</span><span class=o>=</span><span class=s2>&quot;http://127.0.0.1:8088&quot;</span><span class=p>,</span>
</code></pre></div> </li> <li> <p>Run <code>vdirsyncer discover my_calendar</code>.</p> </li> <li>Opened the link in my browser (on my desktop machine).</li> <li> <p>Proceeded with Google authentication until "Firefox can not connect to 127.0.0.1:8088." was displayed. from the browser's address bar that looked like:</p> <p><a href="http://127.0.0.1:8088/?state=SOMETHING&code=HERECOMESTHECODE&scope=https://www.googleapis.com/auth/calendar">http://127.0.0.1:8088/?state=SOMETHING&amp;code=HERECOMESTHECODE&amp;scope=https://www.googleapis.com/auth/calendar</a> * Copy the <code>HERECOMESTHECODE</code> part. * Paste the code into the session where <code>vdirsyncer</code> was running</p> </li> </ul> <h4 id=see-differences-between-syncs>See differences between syncs<a class=headerlink href=#see-differences-between-syncs title="Permanent link">⚑</a></h4> <p>If you create a git repository where you have your calendars you can do a <code>git diff</code> and see the files that have changed. If you do a commit after each sync you can have all the history.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">⚑</a></h2> <ul> <li><a href=https://vdirsyncer.pimutils.org/en/stable/ >Docs</a></li> <li><a href=https://github.com/pimutils/vdirsyncer>Git</a></li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-08-30T08:35:48+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-30</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/benkyonodo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.top", "content.code.annotate", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.8fd75fb4.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> </body> </html>