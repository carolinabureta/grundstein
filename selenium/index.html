<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=My><meta name=author content=Lyz><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.11"><title>Selenium - The green Book</title><link rel=stylesheet href=../assets/stylesheets/main.7e359304.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../stylesheets/extra.css><link rel=stylesheet href=../stylesheets/links.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#web-driver-backends class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> </div> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="The green Book" class="md-header__button md-logo" aria-label="The green Book" data-md-component=logo> <img src=../img/moo_labastelaria.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> The green Book </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Selenium </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/realcaptainsolaris/redbook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> realcaptainsolaris/redbook </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="The green Book" class="md-nav__button md-logo" aria-label="The green Book" data-md-component=logo> <img src=../img/moo_labastelaria.png alt=logo> </a> The green Book </label> <div class=md-nav__source> <a href=https://github.com/realcaptainsolaris/redbook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> realcaptainsolaris/redbook </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../contact/ class=md-nav__link> <span class=md-ellipsis> Contact </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Uebungen </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Uebungen </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../uebungen/beispiel/ class=md-nav__link> <span class=md-ellipsis> Test1 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> DesignLab </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> DesignLab </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../designlab/slime/ class=md-nav__link> <span class=md-ellipsis> Slime </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> DesignClub </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> DesignClub </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../designclub/concept/ class=md-nav__link> <span class=md-ellipsis> Concept </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#web-driver-backends class=md-nav__link> <span class=md-ellipsis> Web driver backends </span> </a> <nav class=md-nav aria-label="Web driver backends"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#firefox class=md-nav__link> <span class=md-ellipsis> Firefox </span> </a> </li> <li class=md-nav__item> <a href=#chrome class=md-nav__link> <span class=md-ellipsis> Chrome </span> </a> </li> <li class=md-nav__item> <a href=#phantomjs class=md-nav__link> <span class=md-ellipsis> PhantomJS </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#usage class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> <nav class=md-nav aria-label=Usage> <ul class=md-nav__list> <li class=md-nav__item> <a href=#open-a-url class=md-nav__link> <span class=md-ellipsis> Open a URL </span> </a> </li> <li class=md-nav__item> <a href=#get-page-source class=md-nav__link> <span class=md-ellipsis> Get page source </span> </a> </li> <li class=md-nav__item> <a href=#get-current-url class=md-nav__link> <span class=md-ellipsis> Get current url </span> </a> </li> <li class=md-nav__item> <a href=#click-on-element class=md-nav__link> <span class=md-ellipsis> Click on element </span> </a> </li> <li class=md-nav__item> <a href=#close-the-browser class=md-nav__link> <span class=md-ellipsis> Close the browser </span> </a> </li> <li class=md-nav__item> <a href=#change-browser-configuration class=md-nav__link> <span class=md-ellipsis> Change browser configuration </span> </a> <nav class=md-nav aria-label="Change browser configuration"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#disable-loading-of-images class=md-nav__link> <span class=md-ellipsis> Disable loading of images </span> </a> </li> <li class=md-nav__item> <a href=#disable-site-cookies class=md-nav__link> <span class=md-ellipsis> Disable site cookies </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#bypass-selenium-detectors class=md-nav__link> <span class=md-ellipsis> Bypass Selenium detectors </span> </a> <nav class=md-nav aria-label="Bypass Selenium detectors"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#use-undetected-chromedriver class=md-nav__link> <span class=md-ellipsis> Use undetected-chromedriver </span> </a> <nav class=md-nav aria-label="Use undetected-chromedriver"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#installation class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=#usage_1 class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#use-selenium-stealth class=md-nav__link> <span class=md-ellipsis> Use Selenium Stealth </span> </a> <nav class=md-nav aria-label="Use Selenium Stealth"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#installation_1 class=md-nav__link> <span class=md-ellipsis> Installation </span> </a> </li> <li class=md-nav__item> <a href=#usage_2 class=md-nav__link> <span class=md-ellipsis> Usage </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#rotate-the-user-agent class=md-nav__link> <span class=md-ellipsis> Rotate the user agent </span> </a> </li> <li class=md-nav__item> <a href=#changing-browser-properties class=md-nav__link> <span class=md-ellipsis> Changing browser properties </span> </a> </li> <li class=md-nav__item> <a href=#predefined-javascript-variables class=md-nav__link> <span class=md-ellipsis> Predefined Javascript variables </span> </a> </li> <li class=md-nav__item> <a href=#dont-use-selenium class=md-nav__link> <span class=md-ellipsis> Don't use selenium </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#set-timeout-of-a-response class=md-nav__link> <span class=md-ellipsis> Set timeout of a response </span> </a> </li> <li class=md-nav__item> <a href=#get-the-status-code-of-a-response class=md-nav__link> <span class=md-ellipsis> Get the status code of a response </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> <nav class=md-nav aria-label=Troubleshooting> <ul class=md-nav__list> <li class=md-nav__item> <a href=#chromedriver-hangs-up-unexpectedly class=md-nav__link> <span class=md-ellipsis> Chromedriver hangs up unexpectedly </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#issues class=md-nav__link> <span class=md-ellipsis> Issues </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Selenium</h1> <p><a href=https://en.wikipedia.org/wiki/Selenium_%28software%29>Selenium</a> is a portable framework for testing web applications. It also provides a test domain-specific language (Selenese) to write tests in a number of popular programming languages.</p> <h2 id=web-driver-backends>Web driver backends<a class=headerlink href=#web-driver-backends title="Permanent link">⚑</a></h2> <p>Selenium can be used with many browsers, such as <a href=#firefox>Firefox</a>, <a href=#chrome>Chrome</a> or <a href=#phantomjs>PhantomJS</a>. But first, install <code>selenium</code>:</p> <div class=highlight><pre><span></span><code>pip<span class=w> </span>install<span class=w> </span>selenium
</code></pre></div> <h3 id=firefox>Firefox<a class=headerlink href=#firefox title="Permanent link">⚑</a></h3> <p>Assuming you've got firefox already installed, you need to download the <a href=https://github.com/mozilla/geckodriver/releases>geckodriver</a>, unpack the tar and add the <code>geckodriver</code> binary somewhere in your <code>PATH</code>.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>

<span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Firefox</span><span class=p>()</span>

<span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://duckduckgo.com/&quot;</span><span class=p>)</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>If you need to get the status code of the requests use <a href=#chrome>Chrome</a> instead</p> <p>There is an issue with Firefox that doesn't support this feature.</p> </div> <h3 id=chrome>Chrome<a class=headerlink href=#chrome title="Permanent link">⚑</a></h3> <p>We're going to use Chromium instead of Chrome. Download the <a href=https://sites.google.com/chromium.org/driver/downloads>chromedriver</a> of the same version as your Chromium, unpack the tar and add the <code>chromedriver</code> binary somewhere in your <code>PATH</code>.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
<span class=kn>from</span> <span class=nn>selenium.webdriver.chrome.options</span> <span class=kn>import</span> <span class=n>Options</span>

<span class=n>opts</span> <span class=o>=</span> <span class=n>Options</span><span class=p>()</span>
<span class=n>opts</span><span class=o>.</span><span class=n>binary_location</span> <span class=o>=</span> <span class=s1>&#39;/usr/bin/chromium&#39;</span>
<span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>options</span><span class=o>=</span><span class=n>opts</span><span class=p>)</span>

<span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://duckduckgo.com/&quot;</span><span class=p>)</span>
</code></pre></div> <p>If you don't want to see the browser, you can run it in headless mode adding the next line when defining the <code>options</code>:</p> <div class=highlight><pre><span></span><code><span class=n>opts</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&quot;--headless&quot;</span><span class=p>)</span>
</code></pre></div> <h3 id=phantomjs><a href=https://realpython.com/headless-selenium-testing-with-python-and-phantomjs/ >PhantomJS</a><a class=headerlink href=#phantomjs title="Permanent link">⚑</a></h3> <div class="admonition warning"> <p class=admonition-title>PhantomJS is abandoned -&gt; Don't use it</p> <p>The <a href=https://github.com/ariya/phantomjs/issues/15344>development stopped in 2018</a></p> </div> <p>PhantomJS is a headless Webkit, in conjunction with Selenium WebDriver, it can be used to run tests directly from the command line. Since PhantomJS eliminates the need for a graphical browser, tests run much faster.</p> <p><a href=https://stackoverflow.com/questions/36770303/unable-to-load-atom-find-element>Don't install phantomjs from the official repos</a> as it's not a working release -.-. <code>npm install -g phantomjs</code> didn't work either. I had to download the tar from the <a href=https://phantomjs.org/download.html>downloads page</a>, which didn't work either. The project is <a href=https://github.com/ariya/phantomjs/issues/15344>abandoned</a>, so don't use this.</p> <h2 id=usage>Usage<a class=headerlink href=#usage title="Permanent link">⚑</a></h2> <p>Assuming that you've got a configured <code>driver</code>, to get the url you're in after javascript has done it's magic use the <code>driver.current_url</code> method. To return the HTML of the page use <code>driver.page_source</code>.</p> <h3 id=open-a-url>Open a URL<a class=headerlink href=#open-a-url title="Permanent link">⚑</a></h3> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://duckduckgo.com/&quot;</span><span class=p>)</span>
</code></pre></div> <h3 id=get-page-source>Get page source<a class=headerlink href=#get-page-source title="Permanent link">⚑</a></h3> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>page_source</span>
</code></pre></div> <h3 id=get-current-url>Get current url<a class=headerlink href=#get-current-url title="Permanent link">⚑</a></h3> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>current_url</span>
</code></pre></div> <h3 id=click-on-element><a href=https://towardsdatascience.com/using-python-and-selenium-to-automate-filling-forms-and-mouse-clicks-f87c74ed5c0f>Click on element</a><a class=headerlink href=#click-on-element title="Permanent link">⚑</a></h3> <p>Once you've opened the page you want to interact with <code>driver.get()</code>, you need to get the Xpath of the element to click on. You can do that by using your browser inspector, to select the element, and once on the code if you right click there is a "Copy XPath"</p> <p>Once that is done you should have something like this when you paste it down.</p> <div class=highlight><pre><span></span><code><span class=o>//*</span><span class=p>[</span><span class=nd>@id</span><span class=o>=</span><span class=err>”</span><span class=n>react</span><span class=o>-</span><span class=n>root</span><span class=err>”</span><span class=p>]</span><span class=o>/</span><span class=n>section</span><span class=o>/</span><span class=n>main</span><span class=o>/</span><span class=n>article</span><span class=o>/</span><span class=n>div</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>/</span><span class=n>div</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=o>/</span><span class=n>p</span><span class=o>/</span><span class=n>a</span>
</code></pre></div> <p>Similarly it is the same process for the input fields for username, password, and login button.</p> <p>We can go ahead and do that on the current page. We can store these xpaths as strings in our code to make it readable.</p> <p>We should have three xpaths from this page and one from the initial login.</p> <div class=highlight><pre><span></span><code><span class=n>first_login</span> <span class=o>=</span> <span class=s1>&#39;//*[@id=”react-root”]/section/main/article/div[2]/div[2]/p/a&#39;</span>
<span class=n>username_input</span> <span class=o>=</span> <span class=s1>&#39;//*[@id=&quot;react-root&quot;]/section/main/div/article/div/div[1]/div/form/div[2]/div/label/input&#39;</span>
<span class=n>password_input</span> <span class=o>=</span> <span class=s1>&#39;//*[@id=&quot;react-root&quot;]/section/main/div/article/div/div[1]/div/form/div[3]/div/label/input&#39;</span>
<span class=n>login_submit</span> <span class=o>=</span> <span class=s1>&#39;//*[@id=&quot;react-root&quot;]/section/main/div/article/div/div[1]/div/form/div[4]/button/div&#39;</span>
</code></pre></div> <p>Now that we have the xpaths defined we can now tell Selenium webdriver to click and send some keys over for the input fields.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>selenium.webdriver.common.by</span> <span class=kn>import</span> <span class=n>By</span>

<span class=n>driver</span><span class=o>.</span><span class=n>find_element</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=n>first_login</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
<span class=n>driver</span><span class=o>.</span><span class=n>find_element</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=n>username_input</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s2>&quot;username&quot;</span><span class=p>)</span>
<span class=n>driver</span><span class=o>.</span><span class=n>find_element</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=n>password_input</span><span class=p>)</span><span class=o>.</span><span class=n>send_keys</span><span class=p>(</span><span class=s2>&quot;password&quot;</span><span class=p>)</span>
<span class=n>driver</span><span class=o>.</span><span class=n>find_element</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=n>login_submit</span><span class=p>)</span><span class=o>.</span><span class=n>click</span><span class=p>()</span>
</code></pre></div> <div class="admonition note"> <p class=admonition-title>Note</p> <p>Many pages suggest to use methods like <code>find_element_by_name</code>, <code>find_element_by_xpath</code> or <code>find_element_by_id</code>. These <a href=https://stackoverflow.com/questions/74023553/attributeerror-webdriver-object-has-no-attribute-find-elements-by-xpath-in>are deprecated now</a>. You should use <code>find_element(By.</code> instead. So, instead of:</p> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>find_element_by_xpath</span><span class=p>(</span><span class=s2>&quot;your_xpath&quot;</span><span class=p>)</span>
</code></pre></div> <p>It should be now:</p> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>find_element</span><span class=p>(</span><span class=n>By</span><span class=o>.</span><span class=n>XPATH</span><span class=p>,</span> <span class=s2>&quot;your_xpath&quot;</span><span class=p>)</span>
</code></pre></div> <p>Where <code>By</code> <a href=https://stackoverflow.com/questions/44629970/python-selenium-webdriver-name-by-not-defined>is imported</a> with <code>from selenium.webdriver.common.by import By</code>.</p> </div> <h3 id=close-the-browser>Close the browser<a class=headerlink href=#close-the-browser title="Permanent link">⚑</a></h3> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</code></pre></div> <h3 id=change-browser-configuration>Change browser configuration<a class=headerlink href=#change-browser-configuration title="Permanent link">⚑</a></h3> <p>You can pass <code>options</code> to the initialization of the chromedriver to tweak how does the browser behave. To get a list of the actual <code>prefs</code> you can go to <code>chrome://prefs-internals</code>, there you can get the code you need to tweak.</p> <h4 id=disable-loading-of-images>Disable loading of images<a class=headerlink href=#disable-loading-of-images title="Permanent link">⚑</a></h4> <div class=highlight><pre><span></span><code><span class=n>options</span> <span class=o>=</span> <span class=n>ChromeOptions</span><span class=p>()</span>
<span class=n>options</span><span class=o>.</span><span class=n>add_experimental_option</span><span class=p>(</span>
    <span class=s2>&quot;prefs&quot;</span><span class=p>,</span>
    <span class=p>{</span>
        <span class=s2>&quot;profile.default_content_setting_values.images&quot;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
        <span class=s2>&quot;profile.default_content_setting_values.cookies&quot;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
    <span class=p>},</span>
<span class=p>)</span>
</code></pre></div> <h4 id=disable-site-cookies>Disable site cookies<a class=headerlink href=#disable-site-cookies title="Permanent link">⚑</a></h4> <div class=highlight><pre><span></span><code><span class=n>options</span> <span class=o>=</span> <span class=n>ChromeOptions</span><span class=p>()</span>
<span class=n>options</span><span class=o>.</span><span class=n>add_experimental_option</span><span class=p>(</span>
    <span class=s2>&quot;prefs&quot;</span><span class=p>,</span>
    <span class=p>{</span>
        <span class=s2>&quot;profile.default_content_setting_values.cookies&quot;</span><span class=p>:</span> <span class=mi>2</span><span class=p>,</span>
    <span class=p>},</span>
<span class=p>)</span>
</code></pre></div> <h3 id=bypass-selenium-detectors>Bypass Selenium detectors<a class=headerlink href=#bypass-selenium-detectors title="Permanent link">⚑</a></h3> <p>Sometimes web servers react differently if they notice that you're using selenium. Browsers can be detected through different ways and some commonly used mechanisms are as follows:</p> <ul> <li>Implementing captcha / recaptcha to detect the automatic bots.</li> <li>Non-human behaviour (browsing too fast, not scrolling to the visible elements, ...)</li> <li>Using an IP that's flagged as suspicious (VPN, VPS, Tor...)</li> <li>Detecting the term HeadlessChrome within headless Chrome UserAgent</li> <li>Using Bot Management service from <a href=http://www.distilnetworks.com/ >Distil Networks</a>, <a href=https://www.akamai.com/us/en/products/security/bot-manager.jsp>Akamai</a>, <a href=https://datadome.co/product/ >Datadome</a>.</li> </ul> <p>They do it through different mechanisms:</p> <ul> <li><a href=#use-undetected-chromedriver>Use undetected-chromedriver</a></li> <li><a href=#use-selenium-stealth>Use Selenium stealth</a></li> <li><a href=#rotate-the-user-agent>Rotate the user agent</a></li> <li><a href=#changing-browser-properties>Changing browser properties</a></li> <li><a href=#predefined-javascript-variables>Predefined Javascript variables</a></li> <li><a href=#dont-use-selenium>Don't use selenium</a></li> </ul> <p>If you've already been detected, you might get blocked for a plethora of other reasons even after using these methods. So you may have to try accessing the site that was detecting you using a VPN, different user-agent, etc.</p> <h4 id=use-undetected-chromedriver><a href=https://github.com/ultrafunkamsterdam/undetected-chromedriver>Use undetected-chromedriver</a><a class=headerlink href=#use-undetected-chromedriver title="Permanent link">⚑</a></h4> <p><code>undetected-chromedriver</code> is a python library that uses an optimized Selenium Chromedriver patch which does not trigger anti-bot services like Distill Network / Imperva / DataDome / Botprotect.io Automatically downloads the driver binary and patches it.</p> <h5 id=installation>Installation<a class=headerlink href=#installation title="Permanent link">⚑</a></h5> <div class=highlight><pre><span></span><code>pip<span class=w> </span>install<span class=w> </span>undetected-chromedriver
</code></pre></div> <h5 id=usage_1>Usage<a class=headerlink href=#usage_1 title="Permanent link">⚑</a></h5> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>undetected_chromedriver.v2</span> <span class=k>as</span> <span class=nn>uc</span>
<span class=n>driver</span> <span class=o>=</span> <span class=n>uc</span><span class=o>.</span><span class=n>Chrome</span><span class=p>()</span>
<span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;https://nowsecure.nl&#39;</span><span class=p>)</span>  <span class=c1># my own test test site with max anti-bot protection</span>
</code></pre></div> <p>If you want to specify the path to the browser use <code>uc.Chrome(browser_executable_path="/path/to/your/file")</code>.</p> <h4 id=use-selenium-stealth><a href=https://github.com/diprajpatra/selenium-stealth>Use Selenium Stealth</a><a class=headerlink href=#use-selenium-stealth title="Permanent link">⚑</a></h4> <p><code>selenium-stealth</code> is a python package to prevent detection (by doing most of the steps of this guide) by making selenium more stealthy.</p> <div class="admonition note"> <p class=admonition-title>Note</p> <p>It's less maintained than <code>undetected-chromedriver</code> so I'd use that other instead. I leave the section in case it's helpful if the other fails for you.</p> </div> <h5 id=installation_1>Installation<a class=headerlink href=#installation_1 title="Permanent link">⚑</a></h5> <div class=highlight><pre><span></span><code>pip<span class=w> </span>install<span class=w> </span>selenium-stealth
</code></pre></div> <h5 id=usage_2>Usage<a class=headerlink href=#usage_2 title="Permanent link">⚑</a></h5> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
<span class=kn>from</span> <span class=nn>selenium_stealth</span> <span class=kn>import</span> <span class=n>stealth</span>
<span class=kn>import</span> <span class=nn>time</span>

<span class=n>options</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>ChromeOptions</span><span class=p>()</span>
<span class=n>options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=s2>&quot;start-maximized&quot;</span><span class=p>)</span>

<span class=c1># options.add_argument(&quot;--headless&quot;)</span>

<span class=n>options</span><span class=o>.</span><span class=n>add_experimental_option</span><span class=p>(</span><span class=s2>&quot;excludeSwitches&quot;</span><span class=p>,</span> <span class=p>[</span><span class=s2>&quot;enable-automation&quot;</span><span class=p>])</span>
<span class=n>options</span><span class=o>.</span><span class=n>add_experimental_option</span><span class=p>(</span><span class=s1>&#39;useAutomationExtension&#39;</span><span class=p>,</span> <span class=kc>False</span><span class=p>)</span>
<span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>options</span><span class=o>=</span><span class=n>options</span><span class=p>,</span> <span class=n>executable_path</span><span class=o>=</span><span class=sa>r</span><span class=s2>&quot;C:\Users\DIPRAJ\Programming\adclick_bot\chromedriver.exe&quot;</span><span class=p>)</span>

<span class=n>stealth</span><span class=p>(</span><span class=n>driver</span><span class=p>,</span>
        <span class=n>languages</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;en-US&quot;</span><span class=p>,</span> <span class=s2>&quot;en&quot;</span><span class=p>],</span>
        <span class=n>vendor</span><span class=o>=</span><span class=s2>&quot;Google Inc.&quot;</span><span class=p>,</span>
        <span class=n>platform</span><span class=o>=</span><span class=s2>&quot;Win32&quot;</span><span class=p>,</span>
        <span class=n>webgl_vendor</span><span class=o>=</span><span class=s2>&quot;Intel Inc.&quot;</span><span class=p>,</span>
        <span class=n>renderer</span><span class=o>=</span><span class=s2>&quot;Intel Iris OpenGL Engine&quot;</span><span class=p>,</span>
        <span class=n>fix_hairline</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span>
        <span class=p>)</span>

<span class=n>url</span> <span class=o>=</span> <span class=s2>&quot;https://bot.sannysoft.com/&quot;</span>
<span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>url</span><span class=p>)</span>
<span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
<span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</code></pre></div> <p>You can test it with <a href=https://bot.sannysoft.com/ >antibot</a>.</p> <h4 id=rotate-the-user-agent><a href=https://stackoverflow.com/questions/33225947/can-a-website-detect-when-you-are-using-selenium-with-chromedriver>Rotate the user agent</a><a class=headerlink href=#rotate-the-user-agent title="Permanent link">⚑</a></h4> <p>Rotating the UserAgent in every execution of your Test Suite using <a href=https://pypi.python.org/pypi/fake-useragent><code>fake_useragent</code></a> module as follows:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>
<span class=kn>from</span> <span class=nn>selenium.webdriver.chrome.options</span> <span class=kn>import</span> <span class=n>Options</span>
<span class=kn>from</span> <span class=nn>fake_useragent</span> <span class=kn>import</span> <span class=n>UserAgent</span>

<span class=n>options</span> <span class=o>=</span> <span class=n>Options</span><span class=p>()</span>
<span class=n>ua</span> <span class=o>=</span> <span class=n>UserAgent</span><span class=p>()</span>
<span class=n>userAgent</span> <span class=o>=</span> <span class=n>ua</span><span class=o>.</span><span class=n>random</span>
<span class=nb>print</span><span class=p>(</span><span class=n>userAgent</span><span class=p>)</span>
<span class=n>options</span><span class=o>.</span><span class=n>add_argument</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;user-agent=</span><span class=si>{</span><span class=n>userAgent</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>chrome_options</span><span class=o>=</span><span class=n>options</span><span class=p>)</span>
<span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://www.google.co.in&quot;</span><span class=p>)</span>
<span class=n>driver</span><span class=o>.</span><span class=n>quit</span><span class=p>()</span>
</code></pre></div> <p>You can also rotate it with <code>execute_cdp_cmd</code>:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>selenium</span> <span class=kn>import</span> <span class=n>webdriver</span>

<span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>executable_path</span><span class=o>=</span><span class=sa>r</span><span class=s1>&#39;C:\WebDrivers\chromedriver.exe&#39;</span><span class=p>)</span>
<span class=nb>print</span><span class=p>(</span><span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&quot;return navigator.userAgent;&quot;</span><span class=p>))</span>
<span class=c1># Setting user agent as Chrome/83.0.4103.97</span>
<span class=n>driver</span><span class=o>.</span><span class=n>execute_cdp_cmd</span><span class=p>(</span><span class=s1>&#39;Network.setUserAgentOverride&#39;</span><span class=p>,</span> <span class=p>{</span><span class=s2>&quot;userAgent&quot;</span><span class=p>:</span> <span class=s1>&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.97 Safari/537.36&#39;</span><span class=p>})</span>
<span class=nb>print</span><span class=p>(</span><span class=n>driver</span><span class=o>.</span><span class=n>execute_script</span><span class=p>(</span><span class=s2>&quot;return navigator.userAgent;&quot;</span><span class=p>))</span>
</code></pre></div> <h4 id=changing-browser-properties><a href=https://stackoverflow.com/questions/33225947/can-a-website-detect-when-you-are-using-selenium-with-chromedriver>Changing browser properties</a><a class=headerlink href=#changing-browser-properties title="Permanent link">⚑</a></h4> <ul> <li> <p>Changing the property value of navigator for webdriver to undefined as follows:</p> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>execute_cdp_cmd</span><span class=p>(</span><span class=s2>&quot;Page.addScriptToEvaluateOnNewDocument&quot;</span><span class=p>,</span> <span class=p>{</span>
  <span class=s2>&quot;source&quot;</span><span class=p>:</span> <span class=s2>&quot;&quot;&quot;</span>
<span class=s2>    Object.defineProperty(navigator, &#39;webdriver&#39;, {</span>
<span class=s2>      get: () =&gt; undefined</span>
<span class=s2>    })</span>
<span class=s2>  &quot;&quot;&quot;</span>
<span class=p>})</span>
</code></pre></div> <p>You can find a relevant detailed discussion in <a href=https://stackoverflow.com/questions/53039551/selenium-webdriver-modifying-navigator-webdriver-flag-to-prevent-selenium-detec/53040904#53040904>Selenium webdriver: Modifying navigator.webdriver flag to prevent selenium detection</a></p> </li> <li> <p>Changing the values of navigator.plugins, navigator.languages, WebGL, hairline feature, missing image, etc. You can find a relevant detailed discussion in <a href=https://stackoverflow.com/questions/56528631/is-there-a-version-of-selenium-webdriver-that-is-not-detectable/56529616#56529616>Is there a version of selenium webdriver that is not detectable?</a></p> </li> <li> <p>Changing the conventional <a href=https://www.w3schools.com/css/css_rwd_viewport.asp>Viewport</a></p> <p>You can find a relevant detailed discussion in <a href=https://stackoverflow.com/questions/58872451/how-to-bypass-google-captcha-with-selenium-and-python/58876531#58876531>How to bypass Google captcha with Selenium and python?</a></p> </li> </ul> <h4 id=predefined-javascript-variables><a href=https://stackoverflow.com/questions/33225947/can-a-website-detect-when-you-are-using-selenium-with-chromedriver>Predefined Javascript variables</a><a class=headerlink href=#predefined-javascript-variables title="Permanent link">⚑</a></h4> <p>One way of detecting Selenium is by checking for predefined JavaScript variables which appear when running with Selenium. The bot detection scripts usually look anything containing word <code>selenium</code>, <code>webdriver</code> in any of the variables (on window object), and also document variables called <code>$cdc_</code> and <code>$wdc_</code>. Of course, all of this depends on which browser you are on. All the different browsers expose different things.</p> <p>In Chrome, what people had to do was to ensure that <code>$cdc_</code> didn't exist as a document variable.</p> <p>You don't need to go compile the <code>chromedriver</code> yourself, if you open the file with <code>vim</code> and execute <code>:%s/cdc_/dog_/g</code> where <code>dog</code> can be any three characters that will work. With perl you can achieve the same result with:</p> <div class=highlight><pre><span></span><code>perl<span class=w> </span>-pi<span class=w> </span>-e<span class=w> </span><span class=s1>&#39;s/cdc_/dog_/g&#39;</span><span class=w> </span>/path/to/chromedriver
</code></pre></div> <h4 id=dont-use-selenium>Don't use selenium<a class=headerlink href=#dont-use-selenium title="Permanent link">⚑</a></h4> <p>Even with <code>undetected-chromedriver</code>, sometimes servers <a href=https://github.com/ultrafunkamsterdam/undetected-chromedriver/issues/816>are able to detect that you're using selenium</a>.</p> <p>A uglier but maybe efective way to go is not using selenium and do a combination of working directly with the chrome devtools protocol with <a href=https://py-cdp.readthedocs.io/en/latest/overview.html><code>pycdp</code></a> (using <a href=https://github.com/HMaker/python-cdp>this maintained fork</a>) and doing the clicks with <a href=https://pyautogui.readthedocs.io/en/latest/ ><code>pyautogui</code></a>. See an <a href=https://github.com/ultrafunkamsterdam/undetected-chromedriver/issues/816>example on this answer</a>.</p> <p>Keep in mind though that these tools don't look to be actively maintained, and that the approach is quite brittle to site changes. Is there really not other way to achieve what you want?</p> <h3 id=set-timeout-of-a-response><a href=https://stackoverflow.com/questions/17533024/how-to-set-selenium-python-webdriver-default-timeout>Set timeout of a response</a><a class=headerlink href=#set-timeout-of-a-response title="Permanent link">⚑</a></h3> <p>For Firefox and Chromedriver:</p> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>set_page_load_timeout</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
</code></pre></div> <p>The rest:</p> <div class=highlight><pre><span></span><code><span class=n>driver</span><span class=o>.</span><span class=n>implicitly_wait</span><span class=p>(</span><span class=mi>30</span><span class=p>)</span>
</code></pre></div> <p>This will throw a <code>TimeoutException</code> whenever the page load takes more than 30 seconds.</p> <h3 id=get-the-status-code-of-a-response><a href=https://stackoverflow.com/questions/5799228/how-to-get-status-code-by-using-selenium-py-python-code>Get the status code of a response</a><a class=headerlink href=#get-the-status-code-of-a-response title="Permanent link">⚑</a></h3> <p>Surprisingly this is not as easy as with requests, there is no <code>status_code</code> method on the driver, you need to dive into the browser log to get it. Firefox has an <a href=https://github.com/mozilla/geckodriver/issues/284>open issue</a> since 2016 that prevents you from <a href=https://stackoverflow.com/questions/59026421/python-selenium-unable-to-get-browser-console-logs>getting this information</a>. Use Chromium if you need this functionality.</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>selenium.webdriver.common.desired_capabilities</span> <span class=kn>import</span> <span class=n>DesiredCapabilities</span>

<span class=n>capabilities</span> <span class=o>=</span> <span class=n>DesiredCapabilities</span><span class=o>.</span><span class=n>CHROME</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<span class=n>capabilities</span><span class=p>[</span><span class=s1>&#39;goog:loggingPrefs&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;performance&#39;</span><span class=p>:</span> <span class=s1>&#39;ALL&#39;</span><span class=p>}</span>

<span class=n>driver</span> <span class=o>=</span> <span class=n>webdriver</span><span class=o>.</span><span class=n>Chrome</span><span class=p>(</span><span class=n>desired_capabilities</span><span class=o>=</span><span class=n>capabilities</span><span class=p>)</span>

<span class=n>driver</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s2>&quot;https://duckduckgo.com/&quot;</span><span class=p>)</span>
<span class=n>logs</span> <span class=o>=</span> <span class=n>driver</span><span class=o>.</span><span class=n>get_log</span><span class=p>(</span><span class=s2>&quot;performance&quot;</span><span class=p>)</span>
<span class=n>status_code</span> <span class=o>=</span> <span class=n>get_status</span><span class=p>(</span><span class=n>driver</span><span class=o>.</span><span class=n>current_url</span><span class=p>,</span> <span class=n>logs</span><span class=p>)</span>
</code></pre></div> <p>Where <code>get_status</code> is:</p> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>get_status</span><span class=p>(</span><span class=n>url</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>logs</span><span class=p>:</span> <span class=n>List</span><span class=p>[</span><span class=n>Dict</span><span class=p>[</span><span class=nb>str</span><span class=p>,</span> <span class=n>Any</span><span class=p>]])</span> <span class=o>-&gt;</span> <span class=nb>int</span><span class=p>:</span>
<span class=w>    </span><span class=sd>&quot;&quot;&quot;Get the url response status code.</span>

<span class=sd>    Args:</span>
<span class=sd>        url: url to search</span>
<span class=sd>        logs: Browser driver logs</span>
<span class=sd>    Returns:</span>
<span class=sd>        The status code.</span>
<span class=sd>    &quot;&quot;&quot;</span>
    <span class=k>for</span> <span class=n>log</span> <span class=ow>in</span> <span class=n>logs</span><span class=p>:</span>
        <span class=k>if</span> <span class=n>log</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>]:</span>
            <span class=n>data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>log</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>])</span>
            <span class=k>with</span> <span class=n>suppress</span><span class=p>(</span><span class=ne>KeyError</span><span class=p>):</span>
                <span class=k>if</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>][</span><span class=s2>&quot;params&quot;</span><span class=p>][</span><span class=s2>&quot;response&quot;</span><span class=p>][</span><span class=s2>&quot;url&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=n>url</span><span class=p>:</span>
                    <span class=k>return</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>][</span><span class=s2>&quot;params&quot;</span><span class=p>][</span><span class=s2>&quot;response&quot;</span><span class=p>][</span><span class=s2>&quot;status&quot;</span><span class=p>]</span>
    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Error retrieving the status code for url </span><span class=si>{</span><span class=n>url</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
</code></pre></div> <p>You have to use <code>driver.current_url</code> to handle well urls that redirect to other urls.</p> <p>If your url is not catched and you get a <code>ValueError</code>, use the next snippet inside the <code>with suppress(KeyError)</code> statement.</p> <p><div class=highlight><pre><span></span><code><span class=n>content_type</span> <span class=o>=</span> <span class=p>(</span>
    <span class=s2>&quot;text/html&quot;</span>
    <span class=ow>in</span> <span class=n>data</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>][</span><span class=s2>&quot;params&quot;</span><span class=p>][</span><span class=s2>&quot;response&quot;</span><span class=p>][</span><span class=s2>&quot;headers&quot;</span><span class=p>][</span><span class=s2>&quot;content-type&quot;</span><span class=p>]</span>
<span class=p>)</span>
<span class=n>response_received</span> <span class=o>=</span> <span class=p>(</span>
    <span class=n>data</span><span class=p>[</span><span class=s2>&quot;message&quot;</span><span class=p>][</span><span class=s2>&quot;method&quot;</span><span class=p>]</span> <span class=o>==</span> <span class=s2>&quot;Network.responseReceived&quot;</span>
<span class=p>)</span>
<span class=k>if</span> <span class=n>content_type</span> <span class=ow>and</span> <span class=n>response_received</span><span class=p>:</span>
    <span class=nb>__import__</span><span class=p>(</span><span class=s2>&quot;pdb&quot;</span><span class=p>)</span><span class=o>.</span><span class=n>set_trace</span><span class=p>()</span>  <span class=c1># XXX BREAKPOINT</span>
    <span class=k>pass</span>
</code></pre></div> And try to see why <code>url != data["message"]["params"]["response"]["url"]</code>. Sometimes servers redirect the user to a url without the <code>www.</code>.</p> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">⚑</a></h2> <h3 id=chromedriver-hangs-up-unexpectedly>Chromedriver hangs up unexpectedly<a class=headerlink href=#chromedriver-hangs-up-unexpectedly title="Permanent link">⚑</a></h3> <p><a href="https://bugs.chromium.org/p/chromedriver/issues/detail?id=1699">Some say that adding the <code>DBUS_SESSION_BUS_ADDRESS</code> environmental variable</a> fixes it:</p> <div class=highlight><pre><span></span><code><span class=n>os</span><span class=o>.</span><span class=n>environ</span><span class=p>[</span><span class=s2>&quot;DBUS_SESSION_BUS_ADDRESS&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;/dev/null&quot;</span>
</code></pre></div> <p>But it still hangs for me. Right now the only solution I see is to assume it's going to hang and add functionality in your program to resume the work instead of starting from scratch. Ugly I know...</p> <h2 id=issues>Issues<a class=headerlink href=#issues title="Permanent link">⚑</a></h2> <ul> <li><a href=https://github.com/mozilla/geckodriver/issues/284>Firefox driver doesn't have access to the log</a>: Update the section above and start using Firefox instead of Chrome when you need to get the status code of the responses.</li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-08-30T08:35:48+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-30</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/benkyonodo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.top", "content.code.annotate", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.8fd75fb4.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> </body> </html>