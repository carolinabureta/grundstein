<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content=My><meta name=author content=Lyz><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.11"><title>Using warnings to evolve your package - The green Book</title><link rel=stylesheet href=../assets/stylesheets/main.7e359304.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../css/timeago.css><link rel=stylesheet href=../stylesheets/extra.css><link rel=stylesheet href=../stylesheets/links.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#using-warnings class=md-skip> Skip to content </a> </div> <div data-md-component=announce> <aside class=md-banner> <div class="md-banner__inner md-grid md-typeset"> </div> </aside> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="The green Book" class="md-header__button md-logo" aria-label="The green Book" data-md-component=logo> <img src=../img/moo_labastelaria.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> The green Book </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Using warnings to evolve your package </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=blue-grey data-md-color-accent=light-blue aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg> </label> </form> <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/realcaptainsolaris/redbook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> realcaptainsolaris/redbook </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="The green Book" class="md-nav__button md-logo" aria-label="The green Book" data-md-component=logo> <img src=../img/moo_labastelaria.png alt=logo> </a> The green Book </label> <div class=md-nav__source> <a href=https://github.com/realcaptainsolaris/redbook title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> realcaptainsolaris/redbook </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../contact/ class=md-nav__link> <span class=md-ellipsis> Contact </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Uebungen </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Uebungen </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../uebungen/beispiel/ class=md-nav__link> <span class=md-ellipsis> Test1 </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> DesignLab </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> DesignLab </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../designlab/slime.md class=md-nav__link> <span class=md-ellipsis> Slime </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> DesignClub </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> DesignClub </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../designclub/concept.md class=md-nav__link> <span class=md-ellipsis> Concept </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#using-warnings class=md-nav__link> <span class=md-ellipsis> Using warnings </span> </a> <nav class=md-nav aria-label="Using warnings"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#how-to-raise-a-warning class=md-nav__link> <span class=md-ellipsis> How to raise a warning </span> </a> </li> <li class=md-nav__item> <a href=#suppressing-a-warning class=md-nav__link> <span class=md-ellipsis> Suppressing a warning </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#how-to-evolve-your-code class=md-nav__link> <span class=md-ellipsis> How to evolve your code </span> </a> <nav class=md-nav aria-label="How to evolve your code"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#use-environmental-variables class=md-nav__link> <span class=md-ellipsis> Use environmental variables </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-warnings class=md-nav__link> <span class=md-ellipsis> Testing warnings </span> </a> </li> <li class=md-nav__item> <a href=#references class=md-nav__link> <span class=md-ellipsis> References </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1>Using warnings to evolve your package</h1> <p>Regardless of the <a href=../versioning/ >versioning system</a> you're using, once you reach your first stable version, the commitment to your end users must be that you give them time to adapt to the changes in your program. So whenever you want to introduce a breaking change release it under a new interface, and in parallel, start emitting <code>DeprecationWarning</code> or <code>UserWarning</code> messages whenever someone invokes the old one. Maintain this state for a defined period (for example six months), and communicate explicitly in the warning message the timeline for when users have to migrate.</p> <p>This gives everyone time to move to the new interface without breaking their system, and then the library may remove the change and get rid of the old design chains forever. As an added benefit, only people using the old interface will ever see the warning, as opposed to affecting everyone (as seen with the semantic versioning major version bump).</p> <p>If you're following <a href=../semantic_versioning/ >semantic versioning</a> you'd do this change in a <code>minor</code> release, and you'll finally remove the functionality in another <code>minor</code> release. As you've given your users enough time to adequate to the new version of the code, it's not understood as a breaking change.</p> <p>This allows too for your users to be less afraid and <a href=../versioning/#upper-version-pinning><em>stop upper-pinning you in their dependencies</em></a>.</p> <p>Another benefit of using warnings is that if you configure your test runner to <a href=pytest.md#capture-deprecation-warnings>capture the warnings</a> (which you should!) you can use your test suite to see the real impact of the deprecation, you may even realize why was that feature there and that you can't deprecate it at all.</p> <h2 id=using-warnings>Using warnings<a class=headerlink href=#using-warnings title="Permanent link">⚑</a></h2> <p>Even though there are many warnings, I usually use <code>UserWarning</code> or <code>DeprecationWarning</code>. The <a href=https://docs.python.org/3/library/warnings.html#warning-categories>full list is</a>:</p> <table> <thead> <tr> <th>Class</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Warning</td> <td>This is the base class of all warning category classes.</td> </tr> <tr> <td>UserWarning</td> <td>The default category for warn().</td> </tr> <tr> <td>DeprecationWarning</td> <td>Warn other developers about deprecated features.</td> </tr> <tr> <td>FutureWarning</td> <td>Warn other end users of applications about deprecated features.</td> </tr> <tr> <td>SyntaxWarning</td> <td>Warn about dubious syntactic features.</td> </tr> <tr> <td>RuntimeWarning</td> <td>Warn about dubious runtime features.</td> </tr> <tr> <td>PendingDeprecationWarning</td> <td>Warn about features that will be deprecated in the future (ignored by default).</td> </tr> <tr> <td>ImportWarning</td> <td>Warn triggered during the process of importing a module (ignored by default).</td> </tr> <tr> <td>UnicodeWarning</td> <td>Warn related to Unicode.</td> </tr> <tr> <td>BytesWarning</td> <td>Warn related to bytes and bytearray.</td> </tr> <tr> <td>ResourceWarning</td> <td>Warn related to resource usage (ignored by default).</td> </tr> </tbody> </table> <h3 id=how-to-raise-a-warning><a href=https://docs.python.org/3/library/warnings.html>How to raise a warning</a><a class=headerlink href=#how-to-raise-a-warning title="Permanent link">⚑</a></h3> <p>Warning messages are typically issued in situations where it is useful to alert the user of some condition in a program, where that condition doesn’t warrant raising an exception and terminating the program.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>warnings</span>

<span class=k>def</span> <span class=nf>f</span><span class=p>():</span>
    <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>(</span><span class=s1>&#39;Message&#39;</span><span class=p>,</span> <span class=ne>DeprecationWarning</span><span class=p>)</span>
</code></pre></div> <h3 id=suppressing-a-warning><a href=https://stackoverflow.com/questions/9134795/how-to-get-rid-of-specific-warning-messages-in-python-while-keeping-all-other-wa>Suppressing a warning</a><a class=headerlink href=#suppressing-a-warning title="Permanent link">⚑</a></h3> <p>To disable in the whole file, add to the top:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>warnings</span>
<span class=n>warnings</span><span class=o>.</span><span class=n>filterwarnings</span><span class=p>(</span><span class=s2>&quot;ignore&quot;</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=s2>&quot;divide by zero encountered in divide&quot;</span><span class=p>)</span>
</code></pre></div> <p>If you want this to apply to only one section of code, then use the warnings context manager:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>warnings</span>
<span class=k>with</span> <span class=n>warnings</span><span class=o>.</span><span class=n>catch_warnings</span><span class=p>():</span>
    <span class=n>warnings</span><span class=o>.</span><span class=n>filterwarnings</span><span class=p>(</span><span class=s2>&quot;ignore&quot;</span><span class=p>,</span> <span class=n>message</span><span class=o>=</span><span class=s2>&quot;divide by zero encountered in divide&quot;</span><span class=p>)</span>
    <span class=c1># .. your divide-by-zero code ..</span>
</code></pre></div> <p>And if you want to disable it for the whole code base configure <a href=pytest.md#capture-deprecation-warnings>pytest accordingly</a>.</p> <h2 id=how-to-evolve-your-code>How to evolve your code<a class=headerlink href=#how-to-evolve-your-code title="Permanent link">⚑</a></h2> <p>To ensure that the transition is smooth you need to tweak your code so that the user can switch a flag and make sure that their code keeps on working with the new changes. For example imagine that we have a class <code>MyClass</code> with a method <code>my_method</code>.</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>MyClass</span><span class=p>:</span>
    <span class=k>def</span> <span class=nf>my_method</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>argument</span><span class=p>):</span>
        <span class=c1># my_method code goes here</span>
</code></pre></div> <p>You can add an argument <code>deprecate_my_method</code> that defaults to <code>False</code>, or you can take the chance to change the signature of the function, so that if the user is using the old argument, it uses the old behaviour and gets the warning, and if it's using the new argument, it uses the new. The advantage of changing the signature is that you don't need to do another deprecation for the temporal argument flag.</p> <p>!!! note "Or you can <a href=#use-environmental-variables>use environmental variables</a>"</p> <div class=highlight><pre><span></span><code><span class=k>class</span> <span class=nc>MyClass</span><span class=p>:</span>
    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>deprecate_my_method</span> <span class=o>=</span> <span class=kc>False</span><span class=p>):</span>
        <span class=bp>self</span><span class=o>.</span><span class=n>deprecate_my_method</span> <span class=o>=</span> <span class=n>deprecate_my_method</span>

    <span class=k>def</span> <span class=nf>my_method</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>argument</span><span class=p>):</span>
        <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>deprecate_my_method</span><span class=p>:</span>
            <span class=c1># my_method new functionality</span>
        <span class=k>else</span><span class=p>:</span>
            <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>(</span><span class=s2>&quot;Use my_new_method instead&quot;</span><span class=p>,</span> <span class=ne>UserWarning</span><span class=p>)</span>
            <span class=c1># my_method old code goes here</span>
</code></pre></div> <p>That way when users get the new version of your code, if they are not using <code>my_method</code> they won't get the exception, and if they are, they can change how they initialize their classes with <code>MyClass(deprecate_my_method=True)</code>, run their tests tweaking their code to meet the new functionality and make sure that they are ready for the method to be deprecated. Once removed, another UserWarning will be raised to stop using <code>deprecate_my_method</code> as an argument to initialize the class as it is no longer needed.</p> <p>Until you remove the old code, you need to keep both functionalities and make sure all your test suite works with both cases. To do that, create the warning, run the tests and see what tests are raising the exception. For each of them you need to think if this test will make sense with the new code:</p> <ul> <li>If it doesn't, make sure <a href=#testing-warnings>that the warning is raised</a>.</li> <li>If it is, make sure <a href=#testing-warnings>that the warning is raised</a> and create another test with the <code>deprecate_my_method</code> enabled.</li> </ul> <p>Once the deprecation date arrives you'll need to search for the date in your code to see where the warning is raised and used, remove the old functionality and update the tests. If you used a temporal argument to let the users try the new behaviour, issue the warning to deprecate it.</p> <h3 id=use-environmental-variables>Use environmental variables<a class=headerlink href=#use-environmental-variables title="Permanent link">⚑</a></h3> <p>A cleaner way to handle it is with environmental variables, that way you don't need to change the signature of the function twice. I've learned this from <a href=https://github.com/boto/botocore/issues/2705>boto</a> where they informed their users this way:</p> <ul> <li>If you wish to test the new feature we have created a new environment variable <code>BOTO_DISABLE_COMMONNAME</code>. Setting this to <code>true</code> will suppress the warning and use the new functionality.</li> <li>If you are concerned about this change causing disruptions, you can pin your version of <code>botocore</code> to <code>&lt;1.28.0</code> until you are ready to migrate.</li> <li> <p>If you are only concerned about silencing the warning in your logs, use <code>warnings.filterwarnings</code> when instantiating a new service client.</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>warnings</span>
<span class=n>warnings</span><span class=o>.</span><span class=n>filterwarnings</span><span class=p>(</span><span class=s1>&#39;ignore&#39;</span><span class=p>,</span> <span class=n>category</span><span class=o>=</span><span class=ne>FutureWarning</span><span class=p>,</span> <span class=n>module</span><span class=o>=</span><span class=s1>&#39;botocore.client&#39;</span><span class=p>)</span>
</code></pre></div> </li> </ul> <h2 id=testing-warnings>Testing warnings<a class=headerlink href=#testing-warnings title="Permanent link">⚑</a></h2> <p>To test the function with pytest you can use <a href=https://docs.pytest.org/en/stable/how-to/capture-warnings.html#warns><code>pytest.warns</code></a>:</p> <div class=highlight><pre><span></span><code><span class=kn>import</span> <span class=nn>warnings</span>
<span class=kn>import</span> <span class=nn>pytest</span>


<span class=k>def</span> <span class=nf>test_warning</span><span class=p>():</span>
    <span class=k>with</span> <span class=n>pytest</span><span class=o>.</span><span class=n>warns</span><span class=p>(</span><span class=ne>UserWarning</span><span class=p>,</span> <span class=n>match</span><span class=o>=</span><span class=s1>&#39;my warning&#39;</span><span class=p>):</span>
        <span class=n>warnings</span><span class=o>.</span><span class=n>warn</span><span class=p>(</span><span class=s2>&quot;my warning&quot;</span><span class=p>,</span> <span class=ne>UserWarning</span><span class=p>)</span>
</code></pre></div> <p>For the <code>DeprecationWarnings</code> you can use <a href=https://docs.pytest.org/en/stable/how-to/capture-warnings.html#ensuring-code-triggers-a-deprecation-warning><code>deprecated_call</code></a>:</p> <p>Or you can use <a href=https://deprecated.readthedocs.io/en/latest/index.html><code>deprecated</code></a>:</p> <div class=highlight><pre><span></span><code><span class=k>def</span> <span class=nf>test_myfunction_deprecated</span><span class=p>():</span>
    <span class=k>with</span> <span class=n>pytest</span><span class=o>.</span><span class=n>deprecated_call</span><span class=p>():</span>
        <span class=n>f</span><span class=p>()</span>
</code></pre></div> <div class=highlight><pre><span></span><code><span class=nd>@deprecated</span><span class=p>(</span><span class=n>version</span><span class=o>=</span><span class=s1>&#39;1.2.0&#39;</span><span class=p>,</span> <span class=n>reason</span><span class=o>=</span><span class=s2>&quot;You should use another function&quot;</span><span class=p>)</span>
<span class=k>def</span> <span class=nf>some_old_function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>):</span>
    <span class=k>return</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span>
</code></pre></div> <p>But it adds a dependency to your program, although they don't have any downstream dependencies.</p> <h2 id=references>References<a class=headerlink href=#references title="Permanent link">⚑</a></h2> <ul> <li><a href=https://bernat.tech/posts/version-numbers/#a-better-way-to-handle-api-evolution>Bernat post on versioning</a></li> </ul> <aside class=md-source-file> <span class=md-source-file__fact> <span class=md-icon title="Last update"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg> </span> <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class=timeago datetime=2024-08-30T08:35:48+00:00 locale=en></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-08-30</span> </span> </aside> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/benkyonodo target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 480 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.top", "content.code.annotate", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.8fd75fb4.min.js></script> <script src=../js/timeago.min.js></script> <script src=../js/timeago_mkdocs_material.js></script> </body> </html>